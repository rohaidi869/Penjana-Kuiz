<!DOCTYPE html>
<html lang="ms">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kuiz Contoh</title>
<!-- Gunakan font Google 'Cairo' -->
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
<style>
    /* Gaya asas */
    body {
        font-family: 'Cairo', sans-serif; /* Gunakan font Cairo */
        background-color: #f4f4f4;
        margin: 0;
        padding: 20px;
        color: #333;
    }
    .container {
        max-width: 800px;
        margin: auto;
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    h1, h2 {
        text-align: center;
        color: #2c3e50;
    }
    /* Gaya untuk muka surat mula */
    #quiz-start-container {
        text-align: center;
    }
    #quiz-studentName {
        padding: 10px;
        width: 80%;
        max-width: 400px;
        margin: 10px 0;
        border: 1px solid #ccc;
        border-radius: 4px;
        font-size: 16px;
    }
    /* Gaya untuk muka surat kuiz */
    #quiz-quiz-container {
        display: none; /* Disembunyikan pada mulanya */
    }
    #quiz-question {
        font-weight: bold;
        margin-bottom: 15px;
        font-size: 1.1em;
    }
    #quiz-options {
        margin-bottom: 15px;
    }
    #quiz-options button {
        display: block;
        width: 100%;
        margin-bottom: 10px;
        padding: 12px;
        text-align: left;
        background-color: #f0f0f0;
        border: 1px solid #ccc;
        border-radius: 4px;
        cursor: pointer;
        font-family: inherit; /* Warisi font dari body */
        font-size: 16px;
        transition: background-color 0.2s;
    }
    #quiz-options button:hover {
        background-color: #e0e0e0;
    }
    #quiz-options button:disabled {
        background-color: #dcdcdc;
        cursor: not-allowed;
    }
    #quiz-explanation {
        margin-top: 15px;
        padding: 10px;
        border-radius: 4px;
        background-color: #fff9c4; /* Kuning muda untuk penjelasan */
        min-height: 20px; /* Tinggi minimum untuk konsistensi */
    }
    .quiz-nav {
        display: flex;
        justify-content: space-between;
        margin-top: 20px;
    }
    .quiz-nav button {
        padding: 10px 20px;
        background-color: #007bff;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-family: inherit;
        font-size: 16px;
    }
    .quiz-nav button:hover:not(:disabled) {
        background-color: #0056b3;
    }
    .quiz-nav button:disabled {
        background-color: #cccccc;
        cursor: not-allowed;
    }
    /* Gaya untuk muka surat sijil */
    #quiz-certificate {
        display: none; /* Disembunyikan pada mulanya */
        text-align: center;
        padding: 20px;
        border: 1px solid #ccc;
        border-radius: 8px;
        background-color: #e8f5e9; /* Hijau muda untuk sijil */
    }
    #quiz-certificate h2 {
        color: #2e7d32;
    }
    #quiz-certificate p {
        font-size: 1.1em;
        margin: 10px 0;
    }
    #quiz-certificate button {
        margin: 10px 5px;
        padding: 10px 15px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-family: inherit;
        font-size: 16px;
    }
    #quiz-certificate button:nth-child(1) { /* Butang WhatsApp */
        background-color: #25D366;
        color: white;
    }
    #quiz-certificate button:nth-child(1):hover {
        background-color: #128C7E;
    }
    #quiz-certificate button:nth-child(2) { /* Butang Google Sheet */
        background-color: #4285F4;
        color: white;
    }
    #quiz-certificate button:nth-child(2):hover {
        background-color: #3367D6;
    }
    #quiz-certificate button:nth-child(3) { /* Butang Cuba Lagi */
        background-color: #6c757d;
        color: white;
    }
    #quiz-certificate button:nth-child(3):hover {
        background-color: #5a6268;
    }
</style>
</head>
<body>

<div class="container">
    <h1>Kuiz Contoh Psikolinguistik</h1>

    <!-- Muka surat mula -->
    <div id="quiz-start-container">
        <div class="form-group">
            <label for="quiz-studentName">Nama Anda:</label>
            <input type="text" id="quiz-studentName" placeholder="Masukkan nama anda">
        </div>
        <p><strong>Arahan:</strong> Jawab soalan berikut. Penjelasan akan dipaparkan selepas anda memilih jawapan.</p>
        <!-- Butang "Mula Kuiz" yang memanggil startExampleQuiz() -->
        <button onclick="startExampleQuiz()">Mula Kuiz</button>
    </div>

    <!-- Muka surat kuiz -->
    <div id="quiz-quiz-container">
        <p>Soalan <span id="current-question-num">1</span> daripada <span id="total-questions">0</span></p>
        <div id="quiz-question">Soalan akan muncul di sini.</div>
        <div id="quiz-options"></div>
        <div id="quiz-explanation"></div>
        <div class="quiz-nav">
            <button onclick="prevQuizQuestion()" id="prev-btn" disabled>Sebelumnya</button>
            <button onclick="nextQuizQuestion()" id="next-btn">Seterusnya</button>
        </div>
    </div>

    <!-- Muka surat sijil -->
    <div id="quiz-certificate">
        <h2>Sijil Prestasi</h2>
        <p>Nama: <span id="quiz-certName"></span></p>
        <p>Kursus: Psikolinguistik</p>
        <p>Topik: Pemerolehan Bahasa Kedua</p>
        <p>Skor: <span id="quiz-scoreDisplay"></span></p>
        <p>Gred: <span id="quiz-grade"></span></p>
        <p><span id="quiz-motivasi"></span></p>
        <button onclick="sendExampleWhatsApp()">Hantar ke Guru (WhatsApp)</button>
        <button onclick="sendExampleToGoogleSheet()">Hantar ke Google Sheet</button>
        <button onclick="resetQuiz()">Cuba Lagi</button>
    </div>
</div>

<!-- Tag <script> yang mengandungi kod JavaScript -->
<script>
    // Definisi pemboleh ubah global
    const quizProgrammeName = "Diploma Bahasa Arab"; // Ditakrifkan untuk digunakan dalam sendExampleWhatsApp()
    // Fungsi untuk reset contoh kuiz
    function resetQuiz() {
        document.getElementById('quiz-start-container').style.display = 'block';
        document.getElementById('quiz-quiz-container').style.display = 'none';
        document.getElementById('quiz-certificate').style.display = 'none';
        document.getElementById('quiz-studentName').value = '';
        // Tetapkan semula teks butang navigasi
        document.getElementById('next-btn').textContent = 'Seterusnya';
        document.getElementById('prev-btn').disabled = true;
    }
    // Fungsi untuk memainkan bunyi klik
    function playClickSound() {
        const audio = new Audio('https://freesound.org/data/previews/171/171671_2437358-lq.mp3');
        audio.play().catch((e) => {
             console.error("Bunyi klik gagal dimainkan:", e);
             // Bunyi tidak dimainkan, teruskan sahaja
        });
    }
    // Fungsi untuk memainkan bunyi jawapan betul
    function playCorrectSound() {
        const audio = new Audio('https://freesound.org/data/previews/320/320181_5260875-lq.mp3');
        audio.play().catch((e) => {
             console.error("Bunyi betul gagal dimainkan:", e);
             // Bunyi tidak dimainkan, teruskan sahaja
        });
    }
    // Fungsi untuk memainkan bunyi jawapan salah
    function playWrongSound() {
        const audio = new Audio('https://freesound.org/data/previews/256/256113_3263906-lq.mp3');
        audio.play().catch((e) => {
             console.error("Bunyi salah gagal dimainkan:", e);
             // Bunyi tidak dimainkan, teruskan sahaja
        });
    }

    // ===== KOD UNTUK CONTOH KUIZ =====
    const quizData = [
        {
            question: "Apakah definisi psikolinguistik yang paling tepat?",
            options: [
                "Kajian tentang hubungan antara bahasa dan budaya",
                "Kajian tentang struktur bahasa formal",
                "Kajian tentang proses mental dalam pemerolehan dan penggunaan bahasa",
                "Kajian tentang sejarah perkembangan bahasa"
            ],
            answer: "Kajian tentang proses mental dalam pemerolehan dan penggunaan bahasa",
            explanation: "Psikolinguistik adalah bidang interdisipliner yang mengkaji proses kognitif dan mental yang terlibat dalam pemerolehan, pemahaman, dan penghasilan bahasa."
        },
        {
            question: "Teori mana yang mencadangkan bahawa manusia dilahirkan dengan kebolehan semula jadi untuk mempelajari bahasa?",
            options: [
                "Teori Behavioris",
                "Teori Interaksionis",
                "Teori Nativis",
                "Teori Kognitif"
            ],
            answer: "Teori Nativis",
            explanation: "Teori Nativis yang diusulkan oleh Noam Chomsky mencadangkan bahawa manusia mempunyai peranti pemerolehan bahasa (LAD) yang semula jadi."
        },
        {
            question: "Apakah yang dimaksudkan dengan 'pemerolehan bahasa'?",
            options: [
                "Proses pembelajaran bahasa secara formal di sekolah",
                "Proses semula jadi penguasaan bahasa tanpa pengajaran formal",
                "Kajian tentang sejarah perkembangan bahasa",
                "Teknik mengajar bahasa kedua"
            ],
            answer: "Proses semula jadi penguasaan bahasa tanpa pengajaran formal",
            explanation: "Pemerolehan bahasa merujuk kepada proses semula jadi di mana kanak-kanak mempelajari bahasa ibunda mereka tanpa pengajaran formal."
        },
        {
            question: "Faktor utama yang mempengaruhi pemerolehan bahasa kedua ialah:",
            options: [
                "Umur, motivasi, dan pendedahan bahasa",
                "Jantina, bangsa, dan agama",
                "Status sosioekonomi dan lokasi geografi",
                "Semua di atas"
            ],
            answer: "Umur, motivasi, dan pendedahan bahasa",
            explanation: "Kajian menunjukkan umur, motivasi, dan pendedahan bahasa adalah faktor utama yang mempengaruhi kejayaan pemerolehan bahasa kedua."
        },
        {
            question: "Apakah perbezaan utama antara pemerolehan bahasa pertama dan kedua?",
            options: [
                "Pemerolehan bahasa pertama lebih cepat daripada kedua",
                "Pemerolehan bahasa pertama berlaku secara semula jadi, manakala kedua memerlukan pengajaran formal",
                "Tidak ada perbezaan yang ketara",
                "Pemerolehan bahasa kedua hanya berlaku pada kanak-kanak"
            ],
            answer: "Pemerolehan bahasa pertama berlaku secara semula jadi, manakala kedua memerlukan pengajaran formal",
            explanation: "Pemerolehan bahasa pertama berlaku secara semula jadi dalam persekitaran bahasa, manakala pemerolehan bahasa kedua biasanya melibatkan pembelajaran secara sedar dan pengajaran formal."
        }
    ];
    let currentQuizQuestion = 0;
    let quizScore = 0;
    let quizStudentName = '';

    function startExampleQuiz() {
        quizStudentName = document.getElementById('quiz-studentName').value.trim(); // Gunakan trim()
        if (!quizStudentName) {
            alert("Sila masukkan nama anda");
            return;
        }
        document.getElementById('quiz-start-container').style.display = 'none';
        document.getElementById('quiz-quiz-container').style.display = 'block';
        currentQuizQuestion = 0;
        quizScore = 0;
        document.getElementById('total-questions').textContent = quizData.length;
        loadQuizQuestion();
    }

    function loadQuizQuestion() {
        const q = quizData[currentQuizQuestion];
        document.getElementById('current-question-num').textContent = currentQuizQuestion + 1;
        document.getElementById('quiz-question').textContent = q.question; // Gunakan textContent untuk keselamatan
        const optionsDiv = document.getElementById('quiz-options');
        optionsDiv.innerHTML = ''; // Kosongkan pilihan sebelumnya
        document.getElementById('quiz-explanation').textContent = ''; // Kosongkan penjelasan sebelumnya

        q.options.forEach(option => {
            const btn = document.createElement('button');
            btn.textContent = option; // Gunakan textContent
            btn.onclick = () => checkQuizAnswer(option);
            optionsDiv.appendChild(btn);
        });

        // Kemas kini keadaan butang navigasi
        document.getElementById('prev-btn').disabled = (currentQuizQuestion === 0);
        // Tukar teks butang 'Seterusnya' kepada 'Tamam' pada soalan terakhir
        const nextButton = document.getElementById('next-btn');
        if (currentQuizQuestion === quizData.length - 1) {
            nextButton.textContent = "Tamam";
        } else {
            nextButton.textContent = "Seterusnya";
        }
    }

    function checkQuizAnswer(selected) {
        // Pastikan pelajar hanya boleh menjawab sekali per soalan
        if (document.getElementById('quiz-explanation').textContent !== '') {
            return; // Jika penjelasan sudah dipaparkan, abaikan klik tambahan
        }

        playClickSound();
        const q = quizData[currentQuizQuestion];
        const isCorrect = selected === q.answer;
        const explanationElement = document.getElementById('quiz-explanation');
        // Papar penjelasan dengan penunjuk betul/salah
        explanationElement.textContent = (isCorrect ? "✔ Jawapan Betul! " : "✘ Jawapan Salah. ") + q.explanation;
        explanationElement.style.backgroundColor = isCorrect ? '#c8e6c9' : '#ffcdd2'; // Hijau muda / Merah muda

        if (isCorrect) {
            quizScore++; // Naikkan skor hanya sekali
            playCorrectSound();
        } else {
            playWrongSound();
        }
        // Lumpuhkan butang pilihan selepas menjawab
        const optionButtons = document.querySelectorAll('#quiz-options button');
        optionButtons.forEach(button => button.disabled = true);
    }

    function nextQuizQuestion() {
         // Pastikan pelajar telah menjawab sebelum boleh ke soalan seterusnya
        if (document.getElementById('quiz-explanation').textContent === '') {
             alert("Sila pilih satu jawapan terlebih dahulu.");
             return;
        }
        if (currentQuizQuestion < quizData.length - 1) {
            currentQuizQuestion++;
            loadQuizQuestion();
        } else {
            endExampleQuiz();
        }
    }

    function prevQuizQuestion() {
        if (currentQuizQuestion > 0) {
            currentQuizQuestion--;
            loadQuizQuestion();
        }
    }

    function endExampleQuiz() {
        document.getElementById('quiz-quiz-container').style.display = 'none';
        document.getElementById('quiz-certificate').style.display = 'block';
        document.getElementById('quiz-certName').textContent = quizStudentName; // Gunakan textContent
        document.getElementById('quiz-scoreDisplay').textContent = `${quizScore}/${quizData.length}`;
        const percent = (quizScore / quizData.length) * 100;
        let grade, motivasi;
        if (percent >= 90) {
            grade = "Cemerlang";
            motivasi = "Tahniah! Anda menunjukkan penguasaan yang sangat baik!";
        } else if (percent >= 70) {
            grade = "Sangat Baik";
            motivasi = "Teruskan usaha anda. Pencapaian anda sangat membanggakan!";
        } else if (percent >= 50) {
            grade = "Lulus";
            motivasi = "Anda lulus, tetapi masih ada ruang untuk penambahbaikan.";
        } else {
            grade = "Perlu Semakan";
            motivasi = "Jangan putus asa! Teruskan ulang kaji dan cuba lagi.";
        }
        document.getElementById('quiz-grade').textContent = grade; // Gunakan textContent
        document.getElementById('quiz-motivasi').textContent = motivasi; // Gunakan textContent
    }

    function sendExampleWhatsApp() {
        const guruPhone = document.getElementById('guru-phone') ? document.getElementById('guru-phone').value.trim() : '';
        if (!guruPhone) {
            // Alert pengguna jika nombor tidak dimasukkan di penjana (yang tidak ada dalam HTML ini)
            // Tetapi kita masih benarkan hantar dengan nombor kosong sebagai fallback
            // alert("Sila masukkan nombor guru dalam penjana terlebih dahulu");
            // return;
        }
        const phone = guruPhone ? `60${guruPhone}` : '60123456789'; // Nombor dummy jika tiada
        const msg = encodeURIComponent(
            `Nama Program: ${quizProgrammeName}
` +
            `Nama Pelajar: ${quizStudentName}
` +
            `Kursus: Psikolinguistik
` +
            `Topik: Pemerolehan Bahasa Kedua
` +
            `Skor: ${quizScore}/${quizData.length}
` +
            `Gred: ${document.getElementById('quiz-grade').textContent}
` +
            `Tarikh: ${new Date().toLocaleDateString()}`
        );
        window.open(`https://wa.me/${phone}?text=${msg}`, '_blank');
    }

    function sendExampleToGoogleSheet() {
        // Dapatkan elemen google-script dari penjana (tidak wujud dalam HTML ini)
        const googleScriptInput = document.getElementById('google-script');
        const googleScript = googleScriptInput ? googleScriptInput.value.trim() : '';
        if (!googleScript) {
             // Alert pengguna jika URL tidak dimasukkan di penjana
            // alert("Sila masukkan URL Google Script dalam penjana");
            // return;
            alert("Ralat: URL Google Script tidak tersedia.");
            return;
        }
        const data = {
            program: quizProgrammeName,
            name: quizStudentName,
            score: quizScore,
            grade: document.getElementById('quiz-grade').textContent,
            date: new Date().toLocaleDateString(),
            course: "Psikolinguistik",
            topic: "Pemerolehan Bahasa Kedua"
        };
        // Nota: mode 'no-cors' mempunyai had - tidak akan menerima respons dari server.
        // Ia hanya memastikan permintaan dihantar. Untuk maklum balas, perlu CORS yang betul di server.
        fetch(googleScript, {
            method: 'POST',
            mode: 'no-cors', // Had: Tiada akses kepada respons
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        }).then(() => {
             alert('Data dihantar ke Google Sheet');
             console.log("Permintaan POST dihantar ke Google Script:", data);
        }).catch((error) => {
             console.error('Ralat menghantar data ke Google Sheet:', error);
             alert('Ralat berlaku semasa menghantar data. Sila semak URL Google Script.');
        });
    }

    // Pastikan resetQuiz dipanggil sekali pada permulaan untuk keadaan awal yang betul
    window.onload = function() {
        resetQuiz();
    };
</script>

</body>
</html>
